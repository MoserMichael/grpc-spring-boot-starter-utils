/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java library project to get you started.
 * For more details take a look at the 'Building Java & JVM projects' chapter in the Gradle
 * User Manual available at https://docs.gradle.org/6.7/userguide/building_java_projects.html
 */


buildscript {
    dependencies {
        classpath "org.springframework.boot:spring-boot-gradle-plugin:$ver.spring"

    }
}

plugins {
    id 'java' //'java-library'
    id 'com.google.protobuf' version '0.8.12'

}

repositories {
    //jcenter()
    mavenCentral()
    gradlePluginPortal()
}



jar {
    baseName = 'test-protos'
    version =  '0.1.0'
}

dependencies {


    compile "org.springframework.boot:spring-boot-starter:$ver.spring"
    compile "io.grpc:grpc-api:$ver.grpc"
    compile "com.google.api.grpc:proto-google-common-protos:1.17.0"
    compile "com.google.protobuf:protobuf-java:3.12.0"
    compile "io.grpc:grpc-all:$ver.grpc"


    // This dependency is used internally, and not exposed to consumers on their own compile classpath.
    implementation 'com.google.guava:guava:29.0-jre'

    // Use JUnit test framework.
    //testImplementation 'junit:junit:4.13'
    //testCompile "org.springframework.boot:spring-boot-starter-test:$ver.spring"
 

}

sourceSets {
    test {
        proto { srcDir 'src/test/proto' }
    }
}

protobuf {
    protoc {
        artifact = 'com.google.protobuf:protoc:3.10.1'
        generatedFilesBaseDir = "$projectDir/gen"

    }

    generateProtoTasks {
        all()*.plugins {
            grpc {}
            }
    }

    // Locate the codegen plugins
    plugins {

        //protoc {
		//	artifact = "com.google.protobuf:protoc:$ver.grpc"
		//}

        // Locate a plugin with name 'grpc'. This step is optional.
        // If you don't locate it, protoc will try to use "protoc-gen-grpc" from
        // system search path.
        grpc {
            artifact = "io.grpc:protoc-gen-grpc-java:$ver.protocplugin"
            // or
            // path = 'tools/protoc-gen-grpc-java'
        }
        // Any other plugins
    }
}
